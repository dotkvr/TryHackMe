ğŸ“Œ Nmap Cheat Sheet (TryHackMe Essentials)
ğŸŸ¦ Descoberta de Hosts

nmap -sn 10.10.0.0/24 â†’ Descobre hosts ativos (ping scan).

nmap -Pn <IP> â†’ Assume que o host estÃ¡ up mesmo sem ping.

nmap -sL <range> â†’ SÃ³ lista alvos (nÃ£o escaneia).

ğŸŸ© Scans de Portas (TCP/UDP)

nmap -sS <IP> â†’ TCP SYN Scan (stealth, padrÃ£o em pentest).

nmap -sT <IP> â†’ TCP Connect (quando nÃ£o tem root/sudo).

nmap -sU <IP> â†’ UDP Scan (ex.: DNS, SNMP, NTP).

nmap -p- <IP> â†’ Escaneia todas as portas.

nmap -F <IP> â†’ Escaneia 100 portas mais comuns.

nmap --top-ports 1000 <IP> â†’ Escaneia as 1000 portas mais usadas.

nmap -p22,80,443 <IP> â†’ Escaneia portas especÃ­ficas.

ğŸŸ¨ EnumeraÃ§Ã£o (ServiÃ§os e SO)

nmap -sV <IP> â†’ Detecta versÃ£o dos serviÃ§os.

nmap -O <IP> â†’ Identifica sistema operacional.

nmap -A <IP> â†’ Agressivo: inclui -sV, -O, scripts bÃ¡sicos, traceroute.

nmap -sC <IP> â†’ Roda scripts default (NSE).

ğŸŸ§ NSE (Nmap Scripting Engine)

nmap --script vuln <IP> â†’ Testa vulnerabilidades conhecidas.

nmap --script http-* -p80,443 <IP> â†’ Scripts para serviÃ§os web.

nmap --script smb* -p445 <IP> â†’ Scripts para SMB (Windows shares, enumeraÃ§Ã£o).

nmap --script safe,default <IP> â†’ EnumeraÃ§Ã£o inicial sem causar dano.

ğŸŸ¥ Performance & Timing

nmap -T4 <IP> â†’ RÃ¡pido, ainda confiÃ¡vel (mais usado).

nmap -T5 <IP> â†’ Muito rÃ¡pido, mas barulhento.

nmap --max-rate 100 <IP> â†’ MÃ¡x. 100 pacotes/s.

nmap --min-rate 50 <IP> â†’ MÃ­n. 50 pacotes/s.

nmap --host-timeout 2m <IP> â†’ Aborta scan se host demorar >2min.

ğŸŸª SaÃ­da & Logging

nmap -oN scan.txt <IP> â†’ Salva em arquivo normal (txt).

nmap -oA results <IP> â†’ Salva em todos os formatos (.nmap, .gnmap, .xml).

nmap --open <IP> â†’ Mostra apenas portas abertas.

nmap --reason <IP> â†’ Explica o porquÃª de cada resultado.